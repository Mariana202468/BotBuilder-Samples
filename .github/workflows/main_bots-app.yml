# Docs for the Azure Web Apps Deploy action: https://github.com/Azure/webapps-deploy
# More GitHub Actions for Azure: https://github.com/Azure/actions

name: Build and Deploy Echo Bot to Azure Web App
on:
 push:
   branches: [ "main" ]          # se ejecuta en cada commit a main
env:
 NODE_VERSION: "20.x"            # 1) corre con Node 20 estable
 WORKING_DIR: "samples/javascript_nodejs/02.echo-bot"   # 2) carpeta del ejemplo
jobs:
 build-deploy:
   runs-on: ubuntu-latest
   steps:
   - name: Checkout repo
     uses: actions/checkout@v4
   - name: Setup Node ${{ env.NODE_VERSION }}
     uses: actions/setup-node@v4
     with:
       node-version: ${{ env.NODE_VERSION }}
   - name: Install dependencies
     run: npm install
     working-directory: ${{ env.WORKING_DIR }}
   - name: Compress site
     run: zip -r site.zip .
     working-directory: ${{ env.WORKING_DIR }}
   - name: Deploy to Azure Web App
     uses: azure/webapps-deploy@v2
     with:
       app-name: Bots-app                   # ← cámbialo por tu Web App EXACTA
       slot-name: Production
       publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISHPROFILE }}
       package: site.zip
 
